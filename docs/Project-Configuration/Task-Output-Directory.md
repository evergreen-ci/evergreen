# Task Output Directory

The task output directory establishes an API, via the file system, for the
handling of output generated by an Evergreen task. It sits on the top-level of
the task's working directory and contains subdirectories that map to specific
types of task output. Any data written to these subdirectories is automatically
ingested, processed, and persisted in a well defined manner established by each
subdirectory. A subdirectory may require a specification file written by the
task workload detailing versions, formats, etc. In general, each task output
type is free to establish its own requirements, conventions, and behavior.

An Evergreen task can expect the reserved directory and subdirectories to exist
when the task begins to run. The root of the reserved directory lives at the
top-level of the task's working directory: `${workdir}/build`.

## Test Logs

Write test logs to the reserved directory `${workdir}/build/TestLogs` and the
Evergreen agent will automatically ingest and ship anything written there at
the end of the task. The directory structure is maintained and log files are
identified via their path relative to `${workdir}/build/TestLogs` in the
underlying persistence layer.

Logs written to this directory can be merged with other logs from the same task
run via the [test logs API](../API/REST-V2-Usage#tag/tasks/paths/~1tasks~1%7Btask_id%7D~1build~1TestLogs~1%7Bpath%7D/get)
Merging is ordered by log line timestamp.

Use the [attach.results command](Project-Commands#attachresults) to link log
paths to test results.

### Test Log Specification File

The test log specification file is a YAML file that enables configuration for
test log handling, such as schema versioning and log line format. It must have
the following file path: `${workdir}/build/TestLogs/log_spec.yaml`. If the file
does not exist or cannot be read for any reason, an error is logged and the
the default values are used.

Note that this file is not persisted.

```yaml
schema_version: 0
format: text-timestamp
```

| Name             | Type          | Description                                                                      |
| ---------------- | ------------- | -------------------------------------------------------------------------------- |
| `schema_version` | int           | The version of the log specification file. Should be one of: `0`. Defaults to 0. |
| `format`         | string (enum) | The log line format, described below. Defaults to `text`.                        |

Log Line Formats:

- `text`: Plain text, ingested as-is. A timestamp is prepended to each line
  upon ingestion. This is the default format but it is not recommended as log
  merging is timestamp-based.
- `text-timestamp`: Plain text prefixed with a Unix nanosecond timestamp and
  whitespace. For example:
  1575743479637000000 This is a log line.
