!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.returnExports=t()}("undefined"!=typeof self?self:this,function(){var e=this,t=e.DeepDiff;function n(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function a(e,t,n){a.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function i(e,t){i.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function l(e,t){l.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function u(e,t,n){u.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function o(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function f(e){var t=typeof e;return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function h(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}function c(e){var t=0,n=f(e);if("array"===n)return e.forEach(function(e){t+=c(e)}),t+h("[type: array, hash: "+t+"]");if("object"===n){for(var r in e)if(e.hasOwnProperty(r)){var a="[ type: object, key: "+r+", value hash: "+c(e[r])+"]";t+=h(a)}return t}return t+h("[ type: "+n+" ; value: "+e+"]")}function s(e,t,n,r,h,p,d,b){d=d||[];var v=(h=h||[]).slice(0);if(void 0!==p){if(r){if("function"==typeof r&&r(v,p))return;if("object"==typeof r){if(r.prefilter&&r.prefilter(v,p))return;if(r.normalize){var y=r.normalize(v,p,e,t);y&&(e=y[0],t=y[1])}}}v.push(p)}"regexp"===f(e)&&"regexp"===f(t)&&(e=e.toString(),t=t.toString());var g=typeof e,m=typeof t,k="undefined"!==g||d&&d.length>0&&d[d.length-1].lhs&&Object.getOwnPropertyDescriptor(d[d.length-1].lhs,p),j="undefined"!==m||d&&d.length>0&&d[d.length-1].rhs&&Object.getOwnPropertyDescriptor(d[d.length-1].rhs,p);if(!k&&j)n(new i(v,t));else if(!j&&k)n(new l(v,e));else if(f(e)!==f(t))n(new a(v,e,t));else if("date"===f(e)&&e-t!=0)n(new a(v,e,t));else if("object"===g&&null!==e&&null!==t)if(d.filter(function(t){return t.lhs===e}).length)e!==t&&n(new a(v,e,t));else{if(d.push({lhs:e,rhs:t}),Array.isArray(e)){var D;for(b&&(e.sort(function(e,t){return c(e)-c(t)}),t.sort(function(e,t){return c(e)-c(t)})),D=0;D<e.length;D++)D>=t.length?n(new u(v,D,new l(void 0,e[D]))):s(e[D],t[D],n,r,v,D,d,b);for(;D<t.length;)n(new u(v,D,new i(void 0,t[D++])))}else{var w=Object.keys(e),O=Object.keys(t);w.forEach(function(a){var i=O.indexOf(a);i>=0?(s(e[a],t[a],n,r,v,a,d,b),O=o(O,i)):s(e[a],void 0,n,r,v,a,d,b)}),O.forEach(function(e){s(void 0,t[e],n,r,v,e,d,b)})}d.length=d.length-1}else e!==t&&("number"===g&&isNaN(e)&&isNaN(t)||n(new a(v,e,t)))}function p(e,t,n,r){return r=r||[],s(e,t,function(e){e&&r.push(e)},n),r.length?r:void 0}function d(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,a=-1,i=n.path?n.path.length-1:0;++a<i;)void 0===r[n.path[a]]&&(r[n.path[a]]=void 0!==n.path[a+1]&&"number"==typeof n.path[a+1]?[]:{}),r=r[n.path[a]];switch(n.kind){case"A":n.path&&void 0===r[n.path[a]]&&(r[n.path[a]]=[]),function e(t,n,r){if(r.path&&r.path.length){var a,i=t[n],l=r.path.length-1;for(a=0;a<l;a++)i=i[r.path[a]];switch(r.kind){case"A":e(i[r.path[a]],r.index,r.item);break;case"D":delete i[r.path[a]];break;case"E":case"N":i[r.path[a]]=r.rhs}}else switch(r.kind){case"A":e(t[n],r.index,r.item);break;case"D":t=o(t,n);break;case"E":case"N":t[n]=r.rhs}return t}(n.path?r[n.path[a]]:r,n.index,n.item);break;case"D":delete r[n.path[a]];break;case"E":case"N":r[n.path[a]]=n.rhs}}}return n(a,r),n(i,r),n(l,r),n(u,r),Object.defineProperties(p,{diff:{value:p,enumerable:!0},orderIndependentDiff:{value:function(e,t,n,r){return r=r||[],s(e,t,function(e){e&&r.push(e)},n,null,null,null,!0),r.length?r:void 0},enumerable:!0},observableDiff:{value:s,enumerable:!0},orderIndependentObservableDiff:{value:function(e,t,n,r,a,i,l){return s(e,t,n,r,a,i,l,!0)},enumerable:!0},orderIndepHash:{value:c,enumerable:!0},applyDiff:{value:function(e,t,n){e&&t&&s(e,t,function(r){n&&!n(e,t,r)||d(e,t,r)})},enumerable:!0},applyChange:{value:d,enumerable:!0},revertChange:{value:function(e,t,n){if(e&&t&&n&&n.kind){var r,a,i=e;for(a=n.path.length-1,r=0;r<a;r++)void 0===i[n.path[r]]&&(i[n.path[r]]={}),i=i[n.path[r]];switch(n.kind){case"A":!function e(t,n,r){if(r.path&&r.path.length){var a,i=t[n],l=r.path.length-1;for(a=0;a<l;a++)i=i[r.path[a]];switch(r.kind){case"A":e(i[r.path[a]],r.index,r.item);break;case"D":case"E":i[r.path[a]]=r.lhs;break;case"N":delete i[r.path[a]]}}else switch(r.kind){case"A":e(t[n],r.index,r.item);break;case"D":case"E":t[n]=r.lhs;break;case"N":t=o(t,n)}return t}(i[n.path[r]],n.index,n.item);break;case"D":case"E":i[n.path[r]]=n.lhs;break;case"N":delete i[n.path[r]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==t},enumerable:!0},noConflict:{value:function(){return t&&(e.DeepDiff=p,t=null),p},enumerable:!0}}),p.DeepDiff=p,e.DeepDiff=p,p});