{"version":3,"sources":["../../../app/waterfall/waterfall.jsx"],"names":["http","angular","bootstrap","get","getFormattedTime","input","userTz","fmt","moment","tz","format","generateURLParameters","params","ret","p","push","encodeURIComponent","join","getParameterByName","name","url","replace","regex","RegExp","results","exec","decodeURIComponent","updateURLParams","bvFilter","taskFilter","skip","baseURL","paramString","window","history","replaceState","JIRA_REGEX","JiraLink","props","contents","_","isString","children","tokens","split","jiraHost","map","token","i","hasSpace","length","maybeSpace","match","jiraLink","React","Component","Root","updatePaginationContext","serverData","href","location","buildVariantFilter","collapsed","localStorage","getItem","state","shortenCommitMessage","data","handleCollapseChange","bind","handleHeaderLinkClick","handleBuildVariantFilter","handleTaskFilter","loadDataPortion","debounce","versionsOnPage","reduce","versions","m","d","authors","project","currentSkip","current_skip","nextSkip","prevSkip","previous_page_count","total_versions","filter","bv_filter","then","setState","setItem","shortenMessage","rows","collapseInfo","activeTaskStatuses","Toolbar","onCheck","buildVariantFilterFunc","taskFilterFunc","Form","ReactBootstrap","PageButtons","ButtonGroup","nextURL","prevURL","prevURLParams","nextURLParams","PageButton","pageURL","directionIcon","disabled","Button","classes","FilterBox","applyFilter","filterFunction","refs","searchInput","value","placeholder","currentFilter","CollapseButton","handleChange","event","collapsedBuilds","checked","Headers","onLinkClick","version","rolled_up","ids","ActiveVersionHeader","message","messages","author","id_link","commit","revisions","substring","formatted_time","create_times","maxChars","button","HideHeaderButton","textToShow","RolledUpVersionHeader","Popover","OverlayTrigger","versionStr","rolledHeader","popovers","id","RolledUpVersionSummary","versionId","createTime","Date"],"mappings":"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","file":"waterfall.js","sourcesContent":[" /*\n  ReactJS code for the Waterfall page. Grid calls the Variant class for each distro, and the Variant class renders each build variant for every version that exists. In each build variant we iterate through all the tasks and render them as well. The row of headers is just a placeholder at the moment.\n */\n\n// React doesn't provide own functionality for making http calls\n// window.fetch doesn't handle query params\nvar http = angular.bootstrap().get('$http')\n\n// Returns string from datetime object in \"5/7/96 1:15 AM\" format\n// Used to display version headers\nfunction getFormattedTime(input, userTz, fmt) {\n  return moment(input).tz(userTz).format(fmt);\n}\n\nfunction generateURLParameters(params) {\n var ret = [];\n for (var p in params) {\n  ret.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(params[p]));\n }\n return ret.join(\"&\");\n}\n\n// getParameterByName returns the value associated with a given query parameter.\n// Based on: http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript\nfunction getParameterByName(name, url) {\n  name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n  var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\");\n  var results = regex.exec(url);\n  if (!results){\n    return null;\n  }\n  if (!results[2]){\n    return '';\n  }\n  return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n}\n\nfunction updateURLParams(bvFilter, taskFilter, skip, baseURL) {\n  var params = {};\n  if (bvFilter && bvFilter != '')\n    params[\"bv_filter\"]= bvFilter;\n  if (taskFilter && taskFilter != '')\n    params[\"task_filter\"]= taskFilter; \n  params[\"skip\"] = skip\n\n  var paramString = generateURLParameters(params);\n  window.history.replaceState({}, '', baseURL + \"?\" + paramString);\n}\n\nvar JIRA_REGEX = /[A-Z]{1,10}-\\d{1,6}/ig;\n\nclass JiraLink extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    var contents\n\n    if (_.isString(this.props.children)) {\n      let tokens = this.props.children.split(/\\s/);\n      let jiraHost = this.props.jiraHost;\n      \n      contents = _.map(tokens, function(token, i){\n        let hasSpace = i !== (tokens.length - 1);\n        let maybeSpace = hasSpace ? ' ': '';\n        if(token.match(JIRA_REGEX)) {\n          let jiraLink = \"https://\"+jiraHost+\"/browse/\"+token;\n          return (\n             <a href={jiraLink}>{token+maybeSpace}</a>\n          );\n        } else {\n          return token + maybeSpace;\n        }\n      });\n    } else {\n      return null;\n    }\n    return (\n      <div>\n        {contents}\n      </div>\n    );\n  }\n}\n\n\n// The Root class renders all components on the waterfall page, including the grid view and the filter and new page buttons\n// The one exception is the header, which is written in Angular and managed by menu.html\nclass Root extends React.Component{\n  constructor(props){\n    super(props);\n\n    this.updatePaginationContext(window.serverData)\n   \n    const href = window.location.href\n    var buildVariantFilter = getParameterByName('bv_filter', href) || ''\n    var taskFilter = getParameterByName('task_filter', href) || ''\n\n    var collapsed = localStorage.getItem(\"collapsed\") == \"true\";\n\n    this.state = {\n      collapsed: collapsed,\n      shortenCommitMessage: true,\n      buildVariantFilter: buildVariantFilter,\n      taskFilter: taskFilter,\n      data: this.props.data,\n    }\n\n    // Handle state for a collapsed view, as well as shortened header commit messages\n    this.handleCollapseChange = this.handleCollapseChange.bind(this);\n    this.handleHeaderLinkClick = this.handleHeaderLinkClick.bind(this);\n    this.handleBuildVariantFilter = this.handleBuildVariantFilter.bind(this);\n    this.handleTaskFilter = this.handleTaskFilter.bind(this);\n    this.loadDataPortion = _.debounce(this.loadDataPortion, 100)\n  }\n\n  updatePaginationContext(data) {\n    // Initialize newer|older buttons\n    var versionsOnPage = _.reduce(data.versions, function(m, d) {\n      return m + d.authors.length\n    }, 0)\n\n    this.baseURL = \"/waterfall/\" + this.props.project\n    this.currentSkip = data.current_skip\n    this.nextSkip = this.currentSkip + versionsOnPage;\n    this.prevSkip = this.currentSkip - data.previous_page_count\n\n    if (this.nextSkip >= data.total_versions) {\n      this.nextSkip = -1;\n    }\n\n    if (this.currentSkip <= 0) {\n      this.prevSkip = -1;\n    }\n  }\n\n  loadDataPortion(filter) {\n    var params = filter ? {bv_filter: filter} : {}\n    http.get(`/rest/v1/waterfall/${this.props.project}`, {params})\n      .then(({data}) => {\n        this.updatePaginationContext(data)\n        this.setState({data})\n      })\n  }\n\n  handleCollapseChange(collapsed) {\n    localStorage.setItem(\"collapsed\", collapsed);\n    this.setState({collapsed: collapsed});\n  }\n\n  handleBuildVariantFilter(filter) {\n    this.loadDataPortion(filter)\n    updateURLParams(filter, this.state.taskFilter, this.currentSkip, this.baseURL);\n    this.setState({buildVariantFilter: filter});\n  }\n\n  handleTaskFilter(filter) {\n    updateURLParams(this.state.buildVariantFilter, filter, this.currentSkip, this.baseURL);\n    this.setState({taskFilter: filter});\n  }\n\n  handleHeaderLinkClick(shortenMessage) {\n    this.setState({shortenCommitMessage: !shortenMessage});\n  }\n\n  render() {\n    if (this.state.data.rows.length == 0){\n      return (\n        <div> \n          There are no builds for this project.\n        </div>\n        )\n    }\n    var collapseInfo = {\n      collapsed : this.state.collapsed,\n      activeTaskStatuses : ['failed','system-failed'],\n    };\n    return (\n      <div> \n        <Toolbar \n          collapsed={this.state.collapsed} \n          onCheck={this.handleCollapseChange} \n          baseURL={this.baseURL}\n          nextSkip={this.nextSkip} \n          prevSkip={this.prevSkip} \n          buildVariantFilter={this.state.buildVariantFilter}\n          taskFilter={this.state.taskFilter}\n          buildVariantFilterFunc={this.handleBuildVariantFilter}\n          taskFilterFunc={this.handleTaskFilter}\n        /> \n        <Headers \n          shortenCommitMessage={this.state.shortenCommitMessage} \n          versions={this.state.data.versions} \n          onLinkClick={this.handleHeaderLinkClick} \n          userTz={this.props.userTz}\n          jiraHost={this.props.jiraHost}\n        /> \n        <Grid \n          data={this.state.data} \n          collapseInfo={collapseInfo} \n          project={this.props.project} \n          buildVariantFilter={this.state.buildVariantFilter}\n          taskFilter={this.state.taskFilter}\n        />\n      </div>\n    )\n  }\n}\n\n\n// Toolbar\nfunction Toolbar ({collapsed, \n  onCheck, \n  baseURL,\n  nextSkip, \n  prevSkip, \n  buildVariantFilter, \n  taskFilter,\n  buildVariantFilterFunc, \n  taskFilterFunc}) {\n\n  var Form = ReactBootstrap.Form;\n  return (\n    <div className=\"row\">\n      <div className=\"col-xs-12\">\n        <Form inline className=\"waterfall-toolbar pull-right\"> \n          <CollapseButton collapsed={collapsed} onCheck={onCheck} />\n          <FilterBox \n            filterFunction={buildVariantFilterFunc} \n            placeholder={\"Filter variant\"} \n            currentFilter={buildVariantFilter} \n            disabled={false}\n          />\n          <FilterBox \n            filterFunction={taskFilterFunc} \n            placeholder={\"Filter task\"} \n            currentFilter={taskFilter} \n            disabled={collapsed}\n          />\n          <PageButtons \n            nextSkip={nextSkip} \n            prevSkip={prevSkip} \n            baseURL={baseURL}\n            buildVariantFilter={buildVariantFilter} \n            taskFilter={taskFilter} \n          />\n        </Form>\n      </div>\n    </div>\n  )\n};\n\nfunction PageButtons ({prevSkip, nextSkip, baseURL, buildVariantFilter, taskFilter}) {\n  var ButtonGroup = ReactBootstrap.ButtonGroup;\n\n  var nextURL= \"\";\n  var prevURL= \"\";\n\n  var prevURLParams = {};\n  var nextURLParams = {};\n\n  nextURLParams[\"skip\"] = nextSkip;\n  prevURLParams[\"skip\"] = prevSkip;\n  if (buildVariantFilter && buildVariantFilter != '') {\n    nextURLParams[\"bv_filter\"] = buildVariantFilter;\n    prevURLParams[\"bv_filter\"] = buildVariantFilter;\n  }\n  if (taskFilter && taskFilter != '') {\n    nextURLParams[\"task_filter\"] = taskFilter;\n    prevURLParams[\"task_filter\"] = taskFilter;\n  }\n  nextURL = \"?\" + generateURLParameters(nextURLParams);\n  prevURL = \"?\" + generateURLParameters(prevURLParams);\n  return (\n    <span className=\"waterfall-form-item\">\n      <ButtonGroup>\n        <PageButton pageURL={prevURL} disabled={prevSkip < 0} directionIcon=\"fa-chevron-left\" />\n        <PageButton pageURL={nextURL} disabled={nextSkip < 0} directionIcon=\"fa-chevron-right\" />\n      </ButtonGroup>\n    </span>\n  );\n}\n\nfunction PageButton ({pageURL, directionIcon, disabled}) {\n  var Button = ReactBootstrap.Button;\n  var classes = \"fa \" + directionIcon;\n  return (\n    <Button href={pageURL} disabled={disabled}><i className={classes}></i></Button>\n  );\n}\n\nclass FilterBox extends React.Component {\n  constructor(props){\n    super(props);\n    this.applyFilter = this.applyFilter.bind(this);\n  }\n  applyFilter() {\n    this.props.filterFunction(this.refs.searchInput.value)\n  }\n  render() {\n    return <input type=\"text\" ref=\"searchInput\"\n                  className=\"form-control waterfall-form-item\"\n                  placeholder={this.props.placeholder} \n                  value={this.props.currentFilter} onChange={this.applyFilter} \n                  disabled={this.props.disabled}/>\n  }\n}\n\nclass CollapseButton extends React.Component{\n  constructor(props){\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n  }\n  handleChange(event){\n    this.props.onCheck(this.refs.collapsedBuilds.checked);\n  }\n  render() {\n    return (\n      <span className=\"semi-muted waterfall-form-item\">\n        <span id=\"collapsed-prompt\">Show collapsed view</span>\n        <input \n          className=\"checkbox waterfall-checkbox\"\n          type=\"checkbox\"\n          checked={this.props.collapsed}\n          ref=\"collapsedBuilds\"\n          onChange={this.handleChange} \n        />\n      </span>\n    )\n  }\n}\n\n// Headers\n\nfunction Headers ({shortenCommitMessage, versions, onLinkClick, userTz, jiraHost}) {\n  return (\n    <div className=\"row version-header\">\n      <div className=\"variant-col col-xs-2 version-header-rolled\"></div>\n      <div className=\"col-xs-10\">\n        <div className=\"row\">\n        {\n          versions.map(function(version){\n            if (version.rolled_up) {\n              return( \n                <RolledUpVersionHeader \n                  key={version.ids[0]} \n                  version={version} \n                  userTz={userTz} \n                  jiraHost={jiraHost}\n                />\n              );\n            }\n            // Unrolled up version, no popover\n            return (\n              <ActiveVersionHeader \n                key={version.ids[0]} \n                version={version}\n                userTz = {userTz} \n                shortenCommitMessage={shortenCommitMessage} \n                onLinkClick={onLinkClick} \n                jiraHost={jiraHost}\n              />\n            );\n          })\n        }\n        </div>\n      </div>\n    </div>\n  )\n}\n\n\nfunction ActiveVersionHeader({shortenCommitMessage, version, onLinkClick, userTz, jiraHost}) {\n  var message = version.messages[0];\n  var author = version.authors[0];\n  var id_link = \"/version/\" + version.ids[0];\n  var commit = version.revisions[0].substring(0,5);\n  var message = version.messages[0]; \n  var formatted_time = getFormattedTime(version.create_times[0], userTz, 'M/D/YY h:mm A' );\n  const maxChars = 44 \n  var button;\n  if (message.length > maxChars) {\n    // If we shorten the commit message, only display the first maxChars chars\n    if (shortenCommitMessage) {\n      message = message.substring(0, maxChars-3) + \"...\";\n    }\n    button = (\n      <HideHeaderButton onLinkClick={onLinkClick} shortenCommitMessage={shortenCommitMessage} />\n    );\n  }\n\n  return (\n      <div className=\"header-col\">\n        <div className=\"version-header-expanded\">\n          <div className=\"col-xs-12\">\n            <div className=\"row\">\n              <a className=\"githash\" href={id_link}>{commit}</a>\n              {formatted_time}\n            </div>\n          </div>\n          <div className=\"col-xs-12\">\n            <div className=\"row\">\n              <strong>{author}</strong> - <JiraLink jiraHost={jiraHost}>{message}</JiraLink>\n              {button}\n            </div>\n          </div>\n        </div>\n      </div>\n  )\n};\n\nclass HideHeaderButton extends React.Component{\n  constructor(props){\n    super(props);\n    this.onLinkClick = this.onLinkClick.bind(this);\n  }\n  onLinkClick(event){\n    this.props.onLinkClick(this.props.shortenCommitMessage);\n  }\n  render() {\n    var textToShow = this.props.shortenCommitMessage ? \"more\" : \"less\";\n    return (\n      <span onClick={this.onLinkClick}> <a href=\"#\">{textToShow}</a> </span>\n    )\n  }\n}\n\nfunction RolledUpVersionHeader({version, userTz, jiraHost}){\n  var Popover = ReactBootstrap.Popover;\n  var OverlayTrigger = ReactBootstrap.OverlayTrigger;\n  var Button = ReactBootstrap.Button;\n  \n  var versionStr = (version.messages.length > 1) ? \"versions\" : \"version\";\n  var rolledHeader = version.messages.length + \" inactive \" + versionStr; \n \n  var popovers = (\n    <Popover id=\"popover-positioned-bottom\" title=\"\">\n      {\n        version.ids.map(function(id,i) {\n          return <RolledUpVersionSummary \n            author={version.authors[i]}  \n            commit={version.revisions[i]} \n            message={version.messages[i]} \n            versionId={version.ids[i]} \n            key={id} userTz={userTz} \n            createTime={version.create_times[i]} \n            jiraHost={jiraHost} />\n        })\n      }\n    </Popover>\n  );\n\n  return (\n    <div className=\"header-col version-header-rolled\">\n      <OverlayTrigger trigger=\"click\" placement=\"bottom\" overlay={popovers} className=\"col-xs-2\">\n          <span className=\"pointer\"> {rolledHeader} </span>\n      </OverlayTrigger>\n    </div>\n  ) \n}; \nfunction RolledUpVersionSummary ({author, commit, message, versionId, createTime, userTz, jiraHost}) {\n  var formatted_time = getFormattedTime(new Date(createTime), userTz, 'M/D/YY h:mm A' );\n  commit =  commit.substring(0,10);\n    \n  return (\n    <div className=\"rolled-up-version-summary\">\n      <span className=\"version-header-time\">{formatted_time}</span>\n      <br /> \n      <a href={\"/version/\" + versionId}>{commit}</a> - <strong>{author}</strong> \n      <br /> \n      <JiraLink jiraHost={jiraHost}>{message}</JiraLink>\n      <br />\n    </div>\n  );\n}\n\n\n"]}