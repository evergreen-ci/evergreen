buildvariants:
  - name: test
    display_name: "Test Variant"
    tasks:
      - name: multi_step_task

functions:
  "setup":
    - command: shell.exec
      params:
        script: |
          echo "Step 1: Setup - Creating workspace"
          mkdir -p workspace
          echo "Workspace created"

    - command: shell.exec
      params:
        script: |
          echo "Step 2: Setup - Installing dependencies"
          echo "Dependencies installed (simulated)"

tasks:
  - name: multi_step_task
    commands:
      - func: setup

      - command: shell.exec
        params:
          script: |
            echo "Step 3: Building project"
            echo "Build successful"

      - command: shell.exec
        params:
          script: |
            echo "Step 4: Running tests"
            echo "All tests passed"

      - command: shell.exec
        params:
          script: |
            echo "Step 5: Cleanup"
            rm -rf workspace
            echo "Cleanup complete"
